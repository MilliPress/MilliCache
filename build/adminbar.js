(()=>{"use strict";function e(e,t){console.log(`${t}: ${e}`)}document.addEventListener("DOMContentLoaded",(()=>{const t=document.getElementById("wp-admin-bar-millicache");t&&(t.querySelectorAll("a.ab-item").forEach((e=>{const t=new URL(e.href,window.location.origin),a=t.searchParams.get("_millicache");if(!a)return;const s=document.createElement("button");s.className="ab-item",s.innerHTML=e.innerHTML,s.dataset.action=a,s.dataset.targets=t.searchParams.get("_targets")||"",e.parentNode.replaceChild(s,e)})),t.querySelectorAll("button.ab-item").forEach((t=>{t.addEventListener("click",(a=>{if(a.preventDefault(),t.classList.contains("disabled"))return;const s=t.closest("#wp-admin-bar-millicache"),c=t.dataset.action;if(c)try{s.classList.add("flushing"),t.classList.add("disabled"),function(t,a=null){const s=t.startsWith("clear")?"cache":"action",c={action:t};"clear"===t?c.is_network_admin=millicache.is_network_admin:"clear_current"===t?c.request_flags=millicache.request_flags:"clear_targets"===t&&a&&(c.targets=a),wp.apiFetch({path:`/millicache/v1/${s}`,method:"POST",data:c}).then((t=>{e(t.message,t.success?"success":"error")})).catch((t=>{console.error("Error:",t),e(t.message||"Error clearing cache","error")}))}(c,t.dataset.targets?t.dataset.targets.split(","):null)}finally{setTimeout((()=>{s.classList.remove("flushing"),t.classList.remove("disabled")}),750)}}))})))}))})();